<!DOCTYPE HTML>
<html>
	<head>
		<meta name="viewport" content="width=device-width; initial-scale=1; maximum-scale=1; minimum-scale=1; user-scalable=1;">
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<link href="css/interactive.css" type="text/css" rel="stylesheet">
		<script class="jsbin" src="scripts/jquery-2.0.0.min.js"></script>
	</head>
	<body style="zoom:.85;position:relative;margin-top:30px">
		<ul class="examples">
			<li class="r1 col-1 row-1">
				100 followers on Twitter
			</li>
			<li class="r2 col-1 row-2">
				Complimentary email<br>
				from a patient
			</li>
			<li class="r2 col-1 row-3">
				5 new patients on word of<br>
				mouth recommendation
			</li>
			<li class="r1 col-1 row-4">
				Nurse running practice's blog
			</li>
			<li class="r1 col-2 row-1">
				4 stars or higher on Yelp
			</li>
			<li class="r3 col-2 row-2">
				Increased patient trust after<br>
				recognition as an expert in<br>
				a particular area
			</li>
			<li class="r2 col-2 row-3">
				Return on investment in<br>
				Facebook advertisements
			</li>
			<li class="r3 col-2 row-4">
				Decreased no-shows due<br>
				to appointment reminders<br>
				through new messaging system
			</li>
		</ul>
		<article class="diagram">
			<section class="red"></section>
			<section class="blue"></section>
			<section class="yellow"></section>
			<section class="green"></section>
		</article>
	</body>
	<script type="text/javascript">
		$.fn.draggable = function() {
		var offset = null;
		var start = function(e) {
		  var orig = e.originalEvent;
		  var pos = $(this).position();
		  offset = {
			x: orig.changedTouches[0].pageX - pos.left,
			y: orig.changedTouches[0].pageY - pos.top
		  };
		};
		var moveMe = function(e) {
		  e.preventDefault();
		  var orig = e.originalEvent;
		  var x = orig.changedTouches[0].pageX - offset.x + 150;
		  var y = orig.changedTouches[0].pageY - offset.y + 37;
		  $(this).css({
			top: orig.changedTouches[0].pageY - offset.y,
			left: orig.changedTouches[0].pageX - offset.x
		  });
		  if( x > 631 && x < 907 && y < 275){$(".red").addClass("hover");}else{$(".red").removeClass("hover");}
		  if( x > 926 && y < 275){$(".blue").addClass("hover");}else{$(".blue").removeClass("hover");}
		  if( x > 926 && y > 294 && y < 570){$(".yellow").addClass("hover");}else{$(".yellow").removeClass("hover");}
		  if( x > 631 && x < 907 && y > 294 && y < 570){$(".green").addClass("hover");}else{$(".green").removeClass("hover");}
		};
		var drop = function (e) {
		    e.preventDefault();
		    var text = e.target.innerHTML;
		    var forAppend = '<div data-text="' + text + '"></div>';

		    var orig = e.originalEvent;
		    var x = orig.changedTouches[0].pageX - offset.x + 150;
		    var y = orig.changedTouches[0].pageY - offset.y + 37;
		    if (x > 631 && x < 907 && y < 275) { $(".red").append(forAppend); $(this).addClass("drop"); setTimeout(function () { $(".drop").remove(); }, 500); $(".red").removeClass("hover"); }
		    if (x > 926 && y < 275) { $(".blue").append(forAppend); $(this).addClass("drop"); setTimeout(function () { $(".drop").remove(); }, 500); $(".blue").removeClass("hover"); }
		    if (x > 926 && y > 294 && y < 570) { $(".yellow").append(forAppend); $(this).addClass("drop"); setTimeout(function () { $(".drop").remove(); }, 500); $(".yellow").removeClass("hover"); }
		    if (x > 631 && x < 907 && y > 294 && y < 570) { $(".green").append(forAppend); $(this).addClass("drop"); setTimeout(function () { $(".drop").remove(); }, 500); $(".green").removeClass("hover"); }
		}
		this.bind("touchstart", start);
		this.bind("touchmove", moveMe);
		this.bind("touchend", drop);
	  };

		$("li").draggable();

		function GetValues() {
		    var obj = {};

		    obj.red = [];
		    obj.green = [];
		    obj.blue = [];
		    obj.yellow = [];
            
		    $(".red div").each(function () { obj.red.push($(this).data('text')); });
		    $(".green div").each(function () { obj.green.push($(this).data('text')); });
		    $(".blue div").each(function () { obj.blue.push($(this).data('text')); });
		    $(".yellow div").each(function () { obj.yellow.push($(this).data('text')); });
            
		    arrJSON = JSON.stringify(obj);
		    return encodeURIComponent(arrJSON);
		};

		function RestoreState(JSONstring) {
		    var obj = $.parseJSON(decodeURIComponent(JSONstring));

		    $.each(obj.red, function (index, value) { FindAndRestoreLi(value, $(".red")); });
		    $.each(obj.green, function (index, value) { FindAndRestoreLi(value, $(".green")); });
		    $.each(obj.blue, function (index, value) { FindAndRestoreLi(value, $(".blue")); });
		    $.each(obj.yellow, function (index, value) { FindAndRestoreLi(value, $(".yellow")); });
		}

		function FindAndRestoreLi(data, sector) {
		    $(".examples li").filter(function () {
		        var el = $(this);
		        var str = el.text().replace(/ /g, ' ')
		        data = data.replace('<br>', '');

		        if (str == data) {
		            el.remove();
		            sector.append('<div data-text="' + el.html() + '"></div>');
		        }
		    })
		}
	</script>
</html>